<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Drag and drop &mdash; AbstractMenus  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/overrides.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/js/links.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plugin API" href="../dev/general.html" />
    <link rel="prev" title="Menu generator" href="generation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F05454" >

          
          
          <a href="../index.html" class="icon icon-home">
            AbstractMenus
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../start/how_to.html">How to create menu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/hocon.html">HOCON format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/tips.html">Tips</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/menu_structure.html">Menu structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/item_format.html">Item format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/activators.html">Activators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/rules.html">Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/variables.html">Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/text_colors.html">Text formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/placeholders.html">Placeholders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Features</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="logical.html">Logical structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">User input</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="animations.html">Animations</a></li>
<li class="toctree-l1"><a class="reference internal" href="generation.html">Menu generator</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Drag and drop</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#adding-dnd-ability">Adding DnD ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="#listening-for-dnd-events">Listening for DnD events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dnd-placeholders">DnD placeholders</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#for-placed-item">For placed item</a></li>
<li class="toctree-l3"><a class="reference internal" href="#for-taken-item">For taken item</a></li>
<li class="toctree-l3"><a class="reference internal" href="#for-changed-item">For changed item</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rule-placeditem">Rule <code class="docutils literal notranslate"><span class="pre">placedItem</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#special-actions">Special actions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#action-placeitem">Action <code class="docutils literal notranslate"><span class="pre">placeItem</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#action-removeplaced">Action <code class="docutils literal notranslate"><span class="pre">removePlaced</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/general.html">Plugin API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/serializers.html">Types deserializing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/own_types.html">Create own types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/handlers.html">Data Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/variables.html">Variables API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/utils.html">Utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #F05454" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AbstractMenus</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Drag and drop</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="drag-and-drop">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">Drag and drop</a><a class="headerlink" href="#drag-and-drop" title="Permalink to this heading"></a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#drag-and-drop" id="id1">Drag and drop</a></p>
<ul>
<li><p><a class="reference internal" href="#adding-dnd-ability" id="id2">Adding DnD ability</a></p></li>
<li><p><a class="reference internal" href="#listening-for-dnd-events" id="id3">Listening for DnD events</a></p></li>
<li><p><a class="reference internal" href="#dnd-placeholders" id="id4">DnD placeholders</a></p>
<ul>
<li><p><a class="reference internal" href="#for-placed-item" id="id5">For placed item</a></p></li>
<li><p><a class="reference internal" href="#for-taken-item" id="id6">For taken item</a></p></li>
<li><p><a class="reference internal" href="#for-changed-item" id="id7">For changed item</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#rule-placeditem" id="id8">Rule <code class="docutils literal notranslate"><span class="pre">placedItem</span></code></a></p></li>
<li><p><a class="reference internal" href="#special-actions" id="id9">Special actions</a></p>
<ul>
<li><p><a class="reference internal" href="#action-placeitem" id="id10">Action <code class="docutils literal notranslate"><span class="pre">placeItem</span></code></a></p></li>
<li><p><a class="reference internal" href="#action-removeplaced" id="id11">Action <code class="docutils literal notranslate"><span class="pre">removePlaced</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<p>Drag-and-drop (futher DnD) is a feature that allows players to place and take items from inventory. In the same time, menu can change it appearance or behaviour in response for this events.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This feature currently is experimental and has some constraints. For example, you cannot use some DnD actions like placing item by shift-click.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Drag-and-drop feature used in some <a class="reference internal" href="../general/examples.html#examples-advanced"><span class="std std-ref">advanced examples</span></a>.</p>
</div>
<section id="adding-dnd-ability">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Adding DnD ability</a><a class="headerlink" href="#adding-dnd-ability" title="Permalink to this heading"></a></h2>
<p>To allow players place and take items, add <code class="docutils literal notranslate"><span class="pre">draggable</span></code> property to menu root:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span><span class="p">:</span> <span class="s2">&quot;Menu&quot;</span>
<span class="n">size</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">draggable</span><span class="p">:</span> <span class="mi">11</span>
<span class="n">items</span><span class="p">:</span> <span class="p">[</span>
  <span class="o">//</span> <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This property has a <a class="reference internal" href="../general/item_format.html#prop-slot"><span class="std std-ref">Slot</span></a> format. It can accept slot index, range or matrix.
In this example we used slot index for single draggable slot. Now if we put or take item from slot 11, this event will not be cancelled.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Regular menu items cannot be draggable. To place draggable item into menu manually, use <code class="docutils literal notranslate"><span class="pre">placeItem</span></code> action.</p>
</div>
</section>
<section id="listening-for-dnd-events">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Listening for DnD events</a><a class="headerlink" href="#listening-for-dnd-events" title="Permalink to this heading"></a></h2>
<p>There is 3 actions blocks for DnD which may be added to menu root:</p>
<dl class="field-list simple">
<dt class="field-odd">onPlaceItem<span class="colon">:</span></dt>
<dd class="field-odd"><p>Called when some item <strong>placed</strong> into draggable slot.</p>
</dd>
<dt class="field-even">onTakeItem<span class="colon">:</span></dt>
<dd class="field-even"><p>Called when some item <strong>taken</strong> from draggable slot.</p>
</dd>
<dt class="field-odd">onDragItem<span class="colon">:</span></dt>
<dd class="field-odd"><p>Called when <strong>any</strong> of the above events happened.</p>
</dd>
</dl>
<p>For example, we wat to know when player placed item to the menu. Then we need to use <code class="docutils literal notranslate"><span class="pre">onPlaceItem</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span><span class="p">:</span> <span class="s2">&quot;Menu&quot;</span>
<span class="n">size</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">draggable</span><span class="p">:</span> <span class="mi">11</span>
<span class="n">onPlaceItem</span> <span class="p">{</span>
  <span class="n">message</span><span class="p">:</span> <span class="s2">&quot;You placed item in slot 11&quot;</span>
<span class="p">}</span>
<span class="n">items</span><span class="p">:</span> <span class="p">[</span>
  <span class="o">//</span> <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>When player put item into available draggable slot, it will receive message.</p>
<p>These events will be called every time player changed item in draggable slot, even if it just increased it’s amount.</p>
<p>Event <code class="docutils literal notranslate"><span class="pre">onDragItem</span></code> useful for cases when you need to check draggable slot every time player do sometning in menu.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If player closed menu while some items placed in menu, they will be dropped to the ground.</p>
</div>
</section>
<section id="dnd-placeholders">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">DnD placeholders</a><a class="headerlink" href="#dnd-placeholders" title="Permalink to this heading"></a></h2>
<p>There is special placeholders to check properties of dragged item and other related data.
These placeholders uses <a class="reference internal" href="../general/placeholders.html#extractor-item"><span class="std std-ref">Item extractor</span></a> to provide information about dragged item.</p>
<p>DnD placeholders grouped by action types described below. You can play with these placeholders yourself, to understand what kind of data they returns.</p>
<section id="for-placed-item">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">For placed item</a><a class="headerlink" href="#for-placed-item" title="Permalink to this heading"></a></h3>
<p>Has <code class="docutils literal notranslate"><span class="pre">placed_</span></code> prefix, and contains data about last <strong>placed</strong> item. For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%placed_item_type%</span></code> - return type of last placed item.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%placed_item_amount%</span></code> - return amount of last placed item.</p></li>
</ul>
<p>And so on. See <a class="reference internal" href="../general/placeholders.html#extractor-item"><span class="std std-ref">Item extractor</span></a> placeholders for more information.</p>
<p>It also has special placeholder <code class="docutils literal notranslate"><span class="pre">placed_slot</span></code> which returns slot index where item was placed in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If player placed item again and increased it amount, these placeholders will contain info about <strong>placed</strong> item, not the final one. If you want to get info about final item, use <code class="docutils literal notranslate"><span class="pre">changed_</span></code> placeholders or <code class="docutils literal notranslate"><span class="pre">placedItem</span></code> rule.</p>
</div>
</section>
<section id="for-taken-item">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">For taken item</a><a class="headerlink" href="#for-taken-item" title="Permalink to this heading"></a></h3>
<p>Has <code class="docutils literal notranslate"><span class="pre">taken_</span></code> prefix, and contains data about last <strong>taken</strong> item. For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%taken_item_type%</span></code> - return type of last taken item.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%taken_item_amount%</span></code> - return amount of last taken item.</p></li>
</ul>
<p>It also has special placeholder <code class="docutils literal notranslate"><span class="pre">taken_slot</span></code> which returns slot index from where item was taken.</p>
</section>
<section id="for-changed-item">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">For changed item</a><a class="headerlink" href="#for-changed-item" title="Permalink to this heading"></a></h3>
<p>Has <code class="docutils literal notranslate"><span class="pre">changed_</span></code> prefix, and contains data about final item after placing or taking.
For example, if draggable slot has 32 stones, and player put 32 stones again, there will be item with amount <code class="docutils literal notranslate"><span class="pre">64</span></code>.
This item available using <code class="docutils literal notranslate"><span class="pre">changed_</span></code> placeholders.
If you will use <code class="docutils literal notranslate"><span class="pre">placed_</span></code> placeholder instead, it will return info about placed item with amount <code class="docutils literal notranslate"><span class="pre">32</span></code>.</p>
<p>Usage example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%changed_item_type%</span></code> - return type of changed item.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%changed_item_amount%</span></code> - return amount of changed item.</p></li>
</ul>
</section>
</section>
<section id="rule-placeditem">
<span id="rule-placed-item"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">Rule <code class="docutils literal notranslate"><span class="pre">placedItem</span></code></a><a class="headerlink" href="#rule-placeditem" title="Permalink to this heading"></a></h2>
<p>This is a special rule for DnD menus. It allow to check final item inside some draggable slot after placing or taking. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span><span class="p">:</span> <span class="s2">&quot;Menu&quot;</span>
<span class="n">size</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">draggable</span><span class="p">:</span> <span class="mi">11</span>
<span class="n">onDragItem</span> <span class="p">{</span>
  <span class="n">rules</span> <span class="p">{</span>
    <span class="n">placedItem</span> <span class="p">{</span>
      <span class="n">slot</span><span class="p">:</span> <span class="mi">11</span>
      <span class="n">material</span><span class="p">:</span> <span class="n">COBBLESTONE</span>
      <span class="n">count</span><span class="p">:</span> <span class="mi">32</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">actions</span> <span class="p">{</span>
    <span class="n">message</span><span class="p">:</span> <span class="s2">&quot;Success&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">items</span><span class="p">:</span> <span class="p">[</span>
  <span class="o">//</span> <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Here, when player place or take item from slot, it will be checked. If there is at least 32 <code class="docutils literal notranslate"><span class="pre">COBBLESTONE</span></code> items, then player receive <code class="docutils literal notranslate"><span class="pre">Success</span></code> message.</p>
</section>
<section id="special-actions">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Special actions</a><a class="headerlink" href="#special-actions" title="Permalink to this heading"></a></h2>
<section id="action-placeitem">
<span id="action-place-item"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">Action <code class="docutils literal notranslate"><span class="pre">placeItem</span></code></a><a class="headerlink" href="#action-placeitem" title="Permalink to this heading"></a></h3>
<p>This action similar to <code class="docutils literal notranslate"><span class="pre">setButton</span></code>, but it places item which can be taken or changed by player using DnD. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span><span class="p">:</span> <span class="s2">&quot;Menu&quot;</span>
<span class="n">size</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">activators</span> <span class="p">{</span>
  <span class="n">command</span><span class="p">:</span> <span class="s2">&quot;menu&quot;</span>
<span class="p">}</span>
<span class="n">draggable</span><span class="p">:</span> <span class="p">[</span> <span class="o">//</span> <span class="n">Slots</span> <span class="mi">2</span> <span class="ow">and</span> <span class="mi">6</span>
  <span class="s2">&quot;--x---x--&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">onDragItem</span> <span class="p">{</span>
  <span class="n">rules</span> <span class="p">{</span>
    <span class="n">placedItem</span> <span class="p">{</span>
      <span class="n">slot</span><span class="p">:</span> <span class="mi">2</span>
      <span class="n">material</span><span class="p">:</span> <span class="n">COBBLESTONE</span>
      <span class="n">count</span><span class="p">:</span> <span class="mi">32</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">actions</span> <span class="p">{</span>
    <span class="n">placeItem</span> <span class="p">{</span>
      <span class="n">slot</span><span class="p">:</span> <span class="mi">6</span>
      <span class="n">material</span><span class="p">:</span> <span class="n">COAL_ORE</span>
      <span class="n">count</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%c</span><span class="s2">hanged_item_amount%&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">denyActions</span> <span class="p">{</span>
    <span class="n">removePlaced</span><span class="p">:</span> <span class="mi">6</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">items</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="n">slot</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;xx-xxx-xx&quot;</span>
    <span class="p">]</span>
    <span class="n">material</span><span class="p">:</span> <span class="n">BLACK_STAINED_GLASS_PANE</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot; &quot;</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>In this example, if player placed at least 32 cobblestone in slot 2, then coal ore appears in slot 15.
Otherwise, remove placed item from slot 15 if exists.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can’t place item with this action into non-draggable slot.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Events like <code class="docutils literal notranslate"><span class="pre">onPlaceItem</span></code> and other won’t be called if using this action.</p>
</div>
</section>
<section id="action-removeplaced">
<span id="action-remove-placed"></span><h3><a class="toc-backref" href="#id11" role="doc-backlink">Action <code class="docutils literal notranslate"><span class="pre">removePlaced</span></code></a><a class="headerlink" href="#action-removeplaced" title="Permalink to this heading"></a></h3>
<p>Remove placed item from slot. For example, you need to remove item from slot <code class="docutils literal notranslate"><span class="pre">5</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">removePlaced</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
<p>This will fully remove item from inventory.</p>
<p>Or, if you need to remove some amount of items:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">removePlaced</span> <span class="p">{</span>
  <span class="n">slot</span><span class="p">:</span> <span class="mi">5</span>
  <span class="n">count</span><span class="p">:</span> <span class="mi">16</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this case, if item in slot has amount more than 16, it’s amount will be decreased. Otherwise it will be fully removed.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="generation.html" class="btn btn-neutral float-left" title="Menu generator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../dev/general.html" class="btn btn-neutral float-right" title="Plugin API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Nanit.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>